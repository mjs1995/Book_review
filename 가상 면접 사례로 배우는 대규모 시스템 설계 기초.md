# 서평
- 이 책의 목적은 시스템 설계 면접 문제를 푸는 데 안정적으로 적용할 수 있는 전략을 제시하는 것으로 규모 확장성을 갖춘 시스템을 만들기 위 해 필수적인 지식도 제공하고 있습니다. 이 책에서는 시스템 설계 면접 문제들을 공략하는 단계적 접근법도 다루고 있어서 해당 접근법을 실제로 따라하면서 배울 수 있도록 많은 예제를 상세한 설명과 함께 제공하고 있어서 좋았습니다. 

# 사용자 수에 따른 규모 확장
- 규모 확장성과 관계된 설계 문제를 푸는 데 쓰일 유용한 지식들을 배울 수 있습니다.
- 단일 서버
  - 실제 요청
    - 웹 애플리케이션 : 비즈니스 로직, 데이터 저장 등을 처리하기 위해서는 서버 구현용 언어(자바, 파이썬 등)를 사용하고, 프레젠테이션용으로는 클라이언트 구현용 언어(HTML, 자바스크립트 등)를사용함 
    - 모바일 앱 : 모바일 앱과 웹 서버 간 통신을 위해서는 HTTP 프로토콜을 이용함. HTTP 프로토콜을 통해서 반환될 응답 데이터의 포맷으로는 보통 JSON(JavaScript Object Notation)이 그 간결함 덕에 널리 쓰임 
- 데이터 베이스
  - 사용자가 늘면 서버 하나로는 충분하지 않아서 여러 서버를 두어야 함. 하나는 웹/모바일 트래픽 처리 용도고, 다른 하나는 데이터베이스용. 웹/모바일 트래픽 처리 서버(웹 계층)와 데이터베이스 서버(데이터 계층)를 분리하면 그 각각을 독립적으로 확장해 나갈 수 있게 됨 
  - 어떤 데이터베이스를 사용할 것인가?
    - 관계형 데이터베이스는 관계형 데이터베이스 관리 시스템(Relational Data-base Management System,RDBMS). RDBMS 가운데 가장 유명한 것으로는 MySQL, 오라클 데이터베이스, PostgreSQL 등이 있음. 관계형 데이터베이스는 자료를 테이블과 열, 칼럼으로 표현함 
    - 비 관계형 데이터베이스는 NoSQL으로 대표적인 것으로는 CouchDB, Neo4j, Cassandra, HBase, Amazon DynamoDB 등이 있음. 
    - NOSQL은 다시 네 분류로 나눠짐. 키 값 저장소, 그래프 저장소, 칼럼 저장소, 문서저장소. 비-관계형 데이터베이스는 일반적으로 조인 연산은 지원하지 않음 
    - 비-관계형 데이터베이스가 바람직한 선택일 경우
      - 아주 낮은 응답 지연시간(latency)이 요구됨
      - 다루는 데이터가 비정형(unstructured)이라 관계형 데이터가 아님
      - 데이터(JSON, YAML, XML 등)를 직렬화하거나(serialize) 역직렬화(deserial-ize) 할 수 있기만 하면 됨 
      - 아주 많은 양의 데이터를 저장할 필요가 있음 
- 수직적 규모 확장 vs 수평적 규모 확장
  - 스케일 업, 수직적 규모 확장(vertical scaling) 프로세스는 서버에 고사양 자원(더 좋은 CPU, 더 많은 RAM 등)을 추가하는 행위를 말함 
  - 스케일 아웃이라고도 하는 수평적 규모 확장 프로세스는 더 많은 서버를 추가하여 성능을 개선하는 행위를 말함
  - 서버로 유입되는 트래픽의 양이 적을 때는 수직적 확장이 좋은 서택이며 가장 큰 장점은 단순함. 단점은 다음과 같음
    - 수직적 규모 확장에는 한계가 있음. 한 대의 서버에 CPU나 메모리를 무한대로 증설할 방법은 없음
    - 수직적 규모 확장법은 장애에 대한 자동복구(failover) 방안이나 다중화(re-dundancy) 방안을 제시하지 않음. 서버에 장애가 발생하면 웹사이트/앱은 완전히 중단됨 
  - 대규모 애플리케이션을 지원하는 데는 수평적 규모 확장법이 보다 적절함 
  - 로드 밸런서 
    - 로드밸런서는 부하 분산 집합(load balancing set)에 속한 웹 서버들에게 트래픽 부하를 고르게 분산하는 역할을 함 
    - 사용자는 로드밸런서의 공개 IP 주소 (public IP address)로 접속함
    - 웹 서버는 클라이언트의 접속을 직접 처리하지 않음. 더 나은 보안을 위해, 서버 간 통신에는 사설 IP 주소(private IP address)가 이용됨. 사설 IP 주소는 같은 네트워크에 속한 서버 사이의 통신에만 쓰일 수 있는 IP주소로, 인터넷을 통해서는 접속할 수 없음. 로드밸런서는 웹 서버와 통신하기 위해 바로 이 사설 주소를 이용함 
    - 부하 분산 집합에 또 하나의 웹 서버를 추가하고 나면 장애를 자동복구하지 못하는 문제(no failover)는 해소되며, 웹 계층의 가용성(availability)은 향상됨 
      - 서버 1이 다운되면(offline) 모든 트래픽은 서버 2로 전송됨. 웹 사이트 전체가 다운되는 일이 방지됨. 부하를 나누기 위해 새로운 서버를 추가할 수도 있음 
      - 웹사이트로 유입되는 트래픽이 가파르게 증가하면 두 대의 서버로 트래픽을 감당할 수 없는 시점이 오는데, 로드밸런서가 있으므로 우아하게 대처할 수 있음. 웹 서버 계층에 더 많은 서버를 추가하기만 하면 됨. 로드밸런스가 자동적으로 트래픽을 분산하기 시작함 
  - 데이터베이스 다중화 
    - 많은 데이터베이스 관리 시스템이 다중화를 지원함. 보통은 서버 사이에 주(master)-부(slave) 관계를 설정하고 데이터 원본은 주서버에, 사본은 부 서버에 저장하는 방식
    - 쓰기 연산(write operation)은 마스터에서만 지원함. 부 데이터베이스는 주 데이터베이스로부터 그 사본을 전달받으며, 읽기 연산(read operation)만을 지원함.
    - 데이터베이스를 변경하는 명령어들, 가령 insert, delete, update 등은 주 데이터베이스로만 전달되어야 함 
    - 대부분의 애플리케이션은 읽기 연산의 비중이 쓰기 연산보다 훨씬 높음 
    - 이점
      - 더 나은 성능 
        - 주-부 다중화 모델에서 모든 데이터 변경 연산은 주 데이터베이스 서버로만 전달되는 반면 읽기 연산은 부 데이터베이스 서버들로 분산됨.
        - 병렬로 처리될 수 있는 질의(query)의 수가 늘어나므로, 성능이 좋아짐 
