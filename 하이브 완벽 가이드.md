# 서평
- 이 책은 데이터 모델링부터 쿼리, 색인, 튜닝, 함수, 스토리지 핸들러, HCatalog 등의 고급 기능까지 총망라하여 제공하고 있다.
- 이 책의 목적은 개발자,데이터베이스 관리자, 아키텍트는 물로인고 비즈니스 분석가처럼 기술 수준이 낮은 사용자에게 이르는 모든 이에게 HiveQL을 예제 중심으로 설명하는 것, 개발자나 하이브 쿼리의 성능 튜닝 및 사용자 정의 함수, 커스텀 데이터 포맷 정의를 사용할 하둡 관리자에게 필요한 기술적 내용을 자세히 제공하는 것 

# 소개
- 맵리듀스 프로그래밍은 큰 연산 작업을 다수의 값싼 서버로 구성된 클러스터에 고르게 나누어 처리하는 프로그래밍 모델로, 비용효율성과 수평확장성을 제공함, 이 연산 모델 아래에는 하둡 분산 파일시스템(HDFS, Hadoop Distributed Filesystem)이라는 분산 파일 시스템이 존재함 
- 하이브는 하둡 클러스터에 있는 데이터를 검색하기 위해 하이브 쿼리 언어(HiveQL) 혹은 HQL이라 부르는 SQL 호환 언어를 제공함 
- 하이브에서 레코드 단위 갱신(record-level update), 삽입, 삭제를 할 수 없긴 하지만 쿼리로 새 테이블을 만들 수 있고 쿼리 결과를 파일로 남길 수도 있음.
- 하둡은 배치처리 기반 시스템(batch-oriented system)이기 때문에 하이브 쿼리 응답 시간이 매우 길음, 맵리듀스의 기동 부하(start-up overhead)가 있기 때문
- 하이브는 트랜잭션을 제공하지 않음
- 큰 규모의 데이터를 다룰 수 있는 OLTP가 필요하면 NoSQL 데이터베이스를 사용하는 것이 더 좋음. NoSQL에는 하둡과 연동된 NoSQL인 HBase, 카산드라, 만약 아마존의 Elastic MapReduce 또는 Elastic Compute Cloud을 이용한다면 다이나모디비와 같은 것도 있음 
- 하이브는 아주 큰 데이터셋을 다루는 곳에서 데이터를 분석하여 정보를 찾아내고 보고서를 만드는 데이터 웨어하우스 애플리케이션에 적합함
- 하둡과 맵리듀스 개요
  - 맵리듀스
    - 맵리듀스는 큰 데이터를 다루는 잡(job)을 여러 태스크(task)로 나누어 다수의 서버로 구성된 클러스터에서 병렬 처리하는 연산 모델. 태스크의 결과를 하나로 합쳐 최종 결과물을 만들 수 있음 
    - 맵리듀스라는 용어는 맵과 리듀스라는 두 개의 기본 데이터 변환연산에서 나왔음. 맵연산은 컬렉션(collection)의 모든 원소를 한 형태에서 다른 형태로 변환함. 이때 입력 키-값(key-value) 쌍은 0개에서 다수의(zero-to-many) 출력 키-값 쌍으로 변환됨. 입력키와 결과키, 입력값과 결과값은 완전히 달라질 수 있음 
    - 맵리듀스에서 같은 키를 가진 모든 키-값 쌍은 컬렉션 형태로 동일한 리듀서 함수에 전달됨. 리듀서 함수의 목적은 값 컬렉션을 합계, 평균과 같은 값으로 변경하거나 다른 컬렉션으로 변경하는 것. 최종 키-값 쌍은 리듀서가 내보냄 
    - 맵리듀스의 입력과 출력에 사용되는 자료구조는 키-값 쌍. 맵퍼가 시작되면 문서의 줄마다 반복 호출됨. 호출할 때 전달되는 키는 문서 시작 부분의 문자 오프셋임
    - 맵퍼는 한 줄의 단어를 키-값 쌍으로 출력함. 정렬과 셔플 단계를 자동으로 처리함. 하둡은 키 순서대로 키-값 쌍을 정렬함. 
    - 셔플 : 같은 키를 가진 키를 모두 모아서 같은 리듀서에게 보냄.
    - 리듀서의 입력 역시 키-값 쌍. 키는 맵퍼에서 나온 단어 중 하나이고 값은 그 단어 발생 횟수의 컬렉션
    - 키 데이터형은 문자열이고 값 데이터형은 정수형 컬렉션
    - 모든 리듀서는 각 단어의 값 컬렉션별로 값을 모두 더하고 단어-총 발생 수 키-값 쌍을 출력해야 함 
- 하둡 생태계에서 하이브
  - SQL 사용자를 위한 친숙한 프로그래밍 모델을 제공할 뿐만 아니라 자바에서 해야 하는 반복적이고 까다로운 코딩을 하지 않도록 해줌 
  - 하이브와 상호동작하는 몇 가지 인터페이스가 있음. CLI, 그래픽 사용자 인터페이스가 편한 사용자는 상용인 Karmasphere, 오픈소스인 클라우데라(Cloudera)의 Hue, Qubole의 새로운 Hive-as-service 등 
  - CLI와 간단한 하이브 웹 인터페이스(HWI), JDBC, ODBC, 쓰리프트(Thrift)서버 
  - 모든 명령어와 쿼리는 입력을 해석하고 필요한 연산을 최적화한 후 보통은 맵리듀스 잡으로 되어있는 단계를 실행하는 드라이버(Driver)로 보내짐 
  - 하이브는 맵리듀스 잡을 시작하기 위해 잡트래커(JobTracker)와 통신함
  - 하이브는 테이블 스키마와 시스템 메타데이터를 보관하기 위한 메타스토어(MetaStore)를 저장하기 위해 별도의 관계형 데이터베이스 (보통 MySQL)을 이용함
  - 하이브는 실시간 응답을 요하는 쿼리나 레코드 수준의 삽입, 갱신, 삭제를 필요로 하지 않는 데이터 웨어하우스 애플리케이션에 적합함
  - 피그 
    - 야후!는 피그를 개발함.
    - 피그는 쿼리 언어가 아닌 데이터 흐름 언어(data flow language), 피그에서는 다른 관계로부터 관계를 정의하기 위해 일련의 선언문을 작성함. 각각의 새로운 관계별로 새로운 데이터 변환을 실행함 
  - HBase
    - HBase는 분산 및 확장 가능한 데이터 저장소. 로우 단위 갱신, 빠른 응답 시간과 로우 단위 트랜잭션을 제공함(복수의 로우 트랜잭션은 제공하지 않음)
    - 칼럼 지향 저장소를 지원하는 것 
  - 캐스케이딩, 크런치, 그 외 도구
    - 모두 JVM 라이브러리
    - 개발자에게 이러한 도구는 튜링 완전체(Turing complete) 프로그래밍 언어의 강력함을 제공함 \
    - 고수준 하둡을 위한 대체 라이브러리
      - 캐스케이딩(Cascading) - 데이터 처리 추상화를 위한 자바 API. 캐스케이딩을 위한 도메인 특화 언어(DSLs)가 있음. 스칼라,그루비,JRuby, Jython
      - 캐스캐로그(Cascalog) - 캐스케이딩용 클로저(Clojure) DSL. 데이터 처리 및 쿼리 추상화를 위한 Datalog로부터 영감을 받은 추가 기능을 제공함
      - 크런치(Crunch) - 데이터 플로우 파이프라인을 위한 자바,스칼라 API
    - 맵리듀스를 사용하지 않는 분산 데이터 처리 도구
      - 스파크(Spark) - 분산된 데이터를 스칼라 API로 처리하는 분산 연산 프레임워크, HDFS와 동작함. 많은 맵리듀스 처리에서 눈에 띄는 성능 향상을 제공함. 하이브를 스파크에 포팅하는 프로젝트도 있으며 샤크라고 불림 
      - 스톰(Storm) - 실시간 이벤트 스트림 처리 시스템
      - 카프카(Kafka) - 분산 메시지 시스템
    - 기타 데이터 처리 언어와 도구
      - R - 통계 분석, 데이터 도식활르 위한 오픈소스 언어로 통계학자, 경제학자 등이 주로 사용함. 분산 시스템이 아니기 때문에 처리할 수 있는 데이터 크기는 제한되어 있음 
      - 매트랩 - 데이터 분석, 수치 연산을 위한 상용 시스템, 엔지니어와 과확자가 주로 사용함
      - 옥타브(Octave) - 매트랩의 오픈소스 버전
      - 메스메티카(Mathmatica) - 상용 데이터 분석, 기호 처리, 수치 계산 시스템. 과학자와 엔지니어가 주로 사용함
      - 사이파이(SciPy), 넘피(NumPy) - 과학 프로그램을 위한 파이썬 확장 소프트웨어 패키지. 데이터 과학자 사이에 널리 사용됨 
